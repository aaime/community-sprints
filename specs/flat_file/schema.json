{
  "$schema": "http://json-schema.org/draft-06/schema#",

  "definitions": {
    "core": {
      "type": "object",
      "properties": {
        "sid": {
          "title": "Unique ID",
          "description": "item ID",
          "type": "string"
        },
        "title": {
          "title": "Title",
          "description": "Human-readable item name",
          "type": "string"
        },
        "bbox": {
          "$ref": "#/definitions/geometry/definitions/bbox"
        },
        "footprint": {
          "oneOf": [
            {
              "$ref": "#/definitions/geometry/definitions/Polygon"
            },
            {
              "$ref": "#/definitions/geometry/definitions/MultiPolygon"
            }
          ]
        },
        "start_date": {
          "title": "Acquisition Date Start",
          "description":
            "First acquisition in UTC (Combined date and time representation)",
          "type": "string",
          "format": "date-time"
        },
        "end_date": {
          "title": "Acquisition Date End",
          "description":
            "Last acquisition in UTC (Combined date and time representation)",
          "type": "string",
          "format": "date-time"
        },
        "product_type": {
          "title": "Product Type",
          "description": "Product types: [eo, sar, model, point-cloud, video]",
          "type": "array",
          "items": {
            "enum": ["eo", "sar", "model", "point-cloud", "video"]
          }
        },
        "provider": {
          "title": "Provider",
          "description": "Provider name and contact",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "#/definitions/catalog/definitions/entity"
            }
          ]
        },
        "license": {
          "title": "Data license",
          "description": "Data license name based on SPDX License List"
        },
        "links": {
          "title": "Resource links",
          "description": "Links to resources, could be download or other URLs",
          "type": "object",
          "additionalProperties": {
            "type": "string",
            "format": "uri"
          }
        },
        "version_spec": {
          "title": "Spec version",
          "description": "Semantic versioning number",
          "type": "string",
          "TODO": "extract this out as semver",
          "pattern": "^\\d+\\.\\d+\\.\\d+(?:-[a-z]+(?:[_\\.-]*[a-z0-9]+)*)*$"
        },
        "version": {
          "title": "Product version",
          "description":
            "The version of the imagery metadata fields, for testing/validation",
          "type": "string",
          "TODO": "extract this out as semver",
          "pattern": "^\\d+\\.\\d+\\.\\d+(?:-[a-z]+(?:[_\\.-]*[a-z0-9]+)*)*$"
        }
      }
    },
    "asset": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/definitions/core"
        },
        {
          "properties": {
            "uri": {
              "type": "string",
              "format": "uri"
            }
          }
        }
      ]
    },
    "catalog": {
      "title": "Catalog",
      "type": "object",
      "definitions": {
        "link": {
          "type": "object",
          "properties": {
            "uri": {
              "type": "string",
              "format": "uri"
            },
            "properties": {
              "$ref": "#/definitions/catalog"
            }
          }
        },
        "entity": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            },
            "email": {
              "type": "string",
              "format": "email"
            },
            "phone": {
              "type": "string"
            },
            "url": {
              "type": "string",
              "format": "uri"
            }
          }
        }
      },
      "properties": {
        "TODO": {
          "TODO": "URL pattern info + frequency"
        },
        "name": {
          "description": "Name",
          "type": "string"
        },
        "description": {
          "description": "Description",
          "type": "string"
        },
        "license": {
          "description": "License (as an SPDX license string)",
          "type": "string"
        },
        "assets": {
          "description": "Assets",
          "type": "array",
          "items": {
            "$ref": "#/definitions/asset"
          }
        },
        "links": {
          "description": "Links to other catalogs",
          "type": "array",
          "items": {
            "$ref": "#/definitions/catalog/definitions/link"
          }
        },
        "contact": {
          "$ref": "#/definitions/catalog/definitions/entity"
        },
        "formats": {
          "description": "Included asset formats",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "keywords": {
          "description": "Keywords",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "homepage": {
          "type": "string"
        },
        "geometry": {
          "oneOf": [
            {
              "$ref": "#/definitions/geometry/definitions/Polygon"
            },
            {
              "$ref": "#/definitions/geometry/definitions/MultiPolygon"
            }
          ]
        },
        "startDate": {
          "type": "string",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "format": "date-time"
        },
        "date": {
          "type": "string",
          "format": "date-time"
        },
        "provider": {
          "description": "Provider-specific properties",
          "type": "object"
        }
      }
    },
    "geometry": {
      "title": "geometry",
      "description": "One geometry as defined by GeoJSON",
      "type": "object",
      "definitions": {
        "position": {
          "description": "A single position",
          "type": "array",
          "minItems": 2,
          "items": [{ "type": "number" }, { "type": "number" }],
          "additionalItems": false
        },
        "positionArray": {
          "description": "An array of positions",
          "type": "array",
          "items": { "$ref": "#/definitions/geometry/definitions/position" }
        },
        "lineString": {
          "description": "An array of two or more positions",
          "allOf": [
            { "$ref": "#/definitions/geometry/definitions/positionArray" },
            { "minItems": 2 }
          ]
        },
        "linearRing": {
          "description":
            "An array of four positions where the first equals the last",
          "allOf": [
            { "$ref": "#/definitions/geometry/definitions/positionArray" },
            { "minItems": 4 }
          ]
        },
        "polygonGeometry": {
          "description": "An array of linear rings",
          "type": "array",
          "items": { "$ref": "#/definitions/geometry/definitions/linearRing" }
        },
        "Point": {
          "title": "Point",
          "properties": {
            "type": { "enum": ["Point"] },
            "coordinates": {
              "$ref": "#/definitions/geometry/definitions/position"
            }
          }
        },
        "MultiPoint": {
          "title": "MultiPoint",
          "properties": {
            "type": { "enum": ["MultiPoint"] },
            "coordinates": {
              "$ref": "#/definitions/geometry/definitions/positionArray"
            }
          }
        },
        "LineString": {
          "title": "LineString",
          "properties": {
            "type": { "enum": ["LineString"] },
            "coordinates": {
              "$ref": "#/definitions/geometry/definitions/lineString"
            }
          }
        },
        "MultiLineString": {
          "title": "MultiLineString",
          "properties": {
            "type": { "enum": ["MultiLineString"] },
            "coordinates": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/geometry/definitions/lineString"
              }
            }
          }
        },
        "Polygon": {
          "title": "Polygon",
          "properties": {
            "type": { "enum": ["Polygon"] },
            "coordinates": {
              "$ref": "#/definitions/geometry/definitions/polygonGeometry"
            }
          }
        },
        "MultiPolygon": {
          "title": "MultiPolygon",
          "properties": {
            "type": { "enum": ["MultiPolygon"] },
            "coordinates": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/geometry/definitions/polygonGeometry"
              }
            }
          }
        },
        "bbox": {
          "title": "Bounding box",
          "type": "array",
          "minItems": 4,
          "maxItems": 4,
          "items": {
            "type": "number"
          }
        }
      },
      "required": ["type", "coordinates"],
      "oneOf": [
        {
          "$ref": "#/definitions/geometry/definitions/Point"
        },
        {
          "$ref": "#/definitions/geometry/definitions/MultiPoint"
        },
        {
          "$ref": "#/definitions/geometry/definitions/LineString"
        },
        {
          "$ref": "#/definitions/geometry/definitions/MultiLineString"
        },
        {
          "$ref": "#/definitions/geometry/definitions/Polygon"
        },
        {
          "$ref": "#/definitions/geometry/definitions/MultiPolygon"
        }
      ]
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/catalog"
    },
    {
      "required": ["name", "description", "license", "assets", "links"]
    }
  ]
}
